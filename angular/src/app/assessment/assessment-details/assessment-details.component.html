<div class="d-flex align-items-stretch h-100" *ngIf="!isLoading">
    <div style="width: 80%" class="container">
        <div>
            <div>
                <h1 class="d-inline">{{ assessment.name }}</h1>
                <button
                    (click)="openUploadDialog(content)"
                    class="btn btn-primary float-right"
                >
                    Upload Script
                </button>
            </div>
            <div>
                <select name="markingSettings" id="markingSettingSelect">
                    <option
                        *ngFor="let setting of markingSettings"
                        value="setting"
                        [selected]="assessment.marking_setting == setting"
                    >
                        {{ setting }}
                    </option>
                </select>
                <button
                    class="btn btn-danger"
                    (click)="deleteAssessment(assessment.id)"
                >
                    Delete
                </button>
                <button
                    class="btn btn-info"
                    (click)="updateAssessment(assessment.id)"
                >
                    Update
                </button>
            </div>
        </div>
        <div id="table-container">
            <table mat-table [dataSource]="answerScripts" class="w-100">
                <!--- Note that these columns can be defined in any order.
                      The actual rendered columns are set as a property on the row definition" -->

                <!-- Position Column -->
                <ng-container matColumnDef="studentName">
                    <th mat-header-cell *matHeaderCellDef>Student Name</th>
                    <td mat-cell *matCellDef="let answer">
                        {{ answer.student_name }}
                    </td>
                </ng-container>

                <!-- Name Column -->
                <ng-container matColumnDef="studentId">
                    <th mat-header-cell *matHeaderCellDef>Student ID</th>
                    <td mat-cell *matCellDef="let answer">
                        {{ answer.student_id }}
                    </td>
                </ng-container>

                <!-- Weight Column -->
                <ng-container matColumnDef="lastUpdate">
                    <th mat-header-cell *matHeaderCellDef>Last Update</th>
                    <td mat-cell *matCellDef="let answer">
                        {{ answer.date_updated | date: "dd/MM/yyyy, hh:mm a" }}
                    </td>
                </ng-container>

                <!-- Symbol Column -->
                <ng-container matColumnDef="status">
                    <th mat-header-cell *matHeaderCellDef>Status</th>
                    <td mat-cell *matCellDef="let answer">
                        {{ answer.status }}
                    </td>
                </ng-container>

                <!-- Symbol Column -->
                <ng-container matColumnDef="marks">
                    <th mat-header-cell *matHeaderCellDef>Marks</th>
                    <td mat-cell *matCellDef="let answer">
                        {{ answer.marks }}
                    </td>
                </ng-container>

                <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
                <tr
                    mat-row
                    *matRowDef="let row; columns: displayedColumns"
                ></tr>
            </table>
        </div>
    </div>
    <div id="sideNav" class="bg-white p-3" style="width: 20%">
        <div id="assessmentBriefInfo">
            <h4>Your Progress</h4>
        </div>
    </div>
</div>

<ng-template #content let-modal>
    <div class="modal-header">
        <h4 class="modal-title">Upload Script</h4>
        <button
            type="button"
            class="btn-close"
            aria-label="Close"
            (click)="modal.dismiss('Cross click')"
        ></button>
    </div>
    <div class="modal-body">
        <small>File types accepted: CSV, ZIP, DOC, DOCX, and PDF.</small>
        <div
            style="height: 250px; border: 2px dashed #4277FF;"
            class="d-flex flex-column align-items-center justify-content-center my-4"
        >
            <fa-icon
                [icon]="faUpload"
                class="text-primary"
                style="font-size: xxx-large"
            ></fa-icon>
            <input
                type="file"
                id="fileInput"
                class="d-none"
                accept=".pdf, .csv, .doc, .docx, .zip"
                (change)="onFileChange($event.target.files)"
            />
            <button
                class="btn btn-outline-primary my-2"
                onclick="document.getElementById('fileInput').click()"
            >
                Choose file
            </button>
            <p *ngIf="!isSubmitDisabled">{{ uploadedFile.name }}</p>
        </div>
    </div>
    <div class="modal-footer">
        <button
            [disabled]="isSubmitDisabled"
            type="submit"
            class="btn btn-primary"
            (click)="bulkUpload()"
        >
            Submit
        </button>
    </div>
</ng-template>

<mat-spinner
    *ngIf="isLoading"
    [strokeWidth]="2"
    [diameter]="150"
    class="mx-auto mt-5"
></mat-spinner>
